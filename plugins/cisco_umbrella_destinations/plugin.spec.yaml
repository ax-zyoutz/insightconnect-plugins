plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: cisco_umbrella_destinations
title: Cisco Umbrella Destinations
version: 1.0.0
description: This plugin utilizes Cisco Umbrella to get the most complete view of the relationships
  and evolution of Internet domains, IP addresses, and autonomous systems to pinpoint
  attackers infrastructures and predict future threats
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/cisco_umbrella_destinations
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.cisco.com
tags:
- cisco
- umbrella
- destinations
hub_tags:
  use_cases: [threat_detection_and_response]
  keywords: [cisco, umbrella, destinations]
  features: []
connection:
  api_key:
    title: API Key
    type: credential_secret_key
    description: Enter API key e.g. 1452d258-7c12-7c12-7c12-1452d25874c2
    required: true
types:
  meta:
    destinationCount:
      type: integer
      description: Total number of destinations in a destination list.
      required: false
    domainCount:
      type: integer
      description: Total number of domains in a destination list. Domains are part of total destinations in a destination lists.
      required: false
    urlCount:
      type: integer
      description: Total number of Urls in a destination list. Urls are part of total destinations in a destination lists.
      required: false
    ipv4Count:
      type: integer
      description: Total number of Ip's in a destination list. Ip's are part of total destinations in a destination lists.
      required: false
  destinations:
    destination:
      type: string
      description: Destination can be domain, url or ip | e.g. <domain_name>
      required: true
    type:
      type: string
      description: Type can be DOMAIN, URL, IPV4 | e.g. DOMAIN
      required: true
    comment:
      type: string
      description: e.g. Added new destination list
      required: false
  dResponse:
    id:
      title: ID
      description: Unique id of the destination list.
      type: integer
      required: false
    organizationId:
      title: Organization Id
      description: ID of org, e.g. 2345678
      type: integer
      required: false
    access:
      title: Access
      description: Access can be allow or block. It defines destinationList type, e.g. allow
      type: string
      required: false
    isGlobal:
      title: Is Global
      description: isGlobal can be true or false. There is only one default destination list of type allow or block for an organization.
      type: boolean
      required: false
    name:
      title: Name
      description: Name of the DL list
      type: string
      required: false
    thirdpartyCategoryId:
      title: Third Party Category Id
      description: example, 0
      type: integer
      required: false
    createdAt:
      title: Created At
      description: example, 1490206249
      type: integer
      required: false
    modifiedAt:
      title: Modified At
      description: example, 1490206249
      type: integer
      required: false
    isMspDefault:
      title: Is MSP Default
      description: example, false
      type: boolean
      required: false
    markedForDeletion:
      title: Marked For Deletion
      description: example, false
      type: boolean
      required: false
    meta:
      title: Meta Data
      description: None
      type: '[]meta'
      required: false
  dlCollection:
    id:
      title: ID
      description: Unique id of the destination list.
      type: integer
      required: true
    organizationId:
      title: Organization Id
      description: ID of org, e.g. 2345678
      type: integer
      required: true
    access:
      title: Access
      description: Access can be allow or block. It defines destinationList type, e.g. allow
      type: string
      required: true
    isGlobal:
      title: Is Global
      description: isGlobal can be true or false. There is only one default destination list of type allow or block for an organization.
      type: boolean
      required: true
    name:
      title: Name
      description: Name of the DL list
      type: string
      required: true
    thirdpartyCategoryId:
      title: Third Party Category Id
      description: example, 0
      type: integer
      required: true
    createdAt:
      title: Created At
      description: example, 1490206249
      type: integer
      required: true
    modifiedAt:
      title: Modified At
      description: example, 1490206249
      type: integer
      required: true
    isMspDefault:
      title: Is MSP Default
      description: example, false
      type: boolean
      required: true
    markedForDeletion:
      title: Marked For Deletion
      description: example, false
      type: boolean
      required: true
    meta:
      title: Meta Data
      description: None
      type: '[]meta'
      required: false
  dlCreate:
    access:
      name: Access
      description: Access can be allow or block. It defines destinationlist type.
      type: string
      required: true
    isGlobal:
      name: Is Global
      description: isGlobal can be true or false. There is only one default destination list of type allow or block for an organization.
      type: boolean
      required: true
    name:
      name: Name
      description: example, New Destination List
      type: string
      required: true
    destinations:
      name: Destinations
      description: Destinations to add to new list
      type: '[]destinations'
      required: false
  dlPatch:
    name:
      name: Name
      description: Name of the destination list
      type: string
      required: true
  destinationsList:
    destination:
      name: Destination Name
      description: Name of the destination
      type: string
      required: true
    comment:
      name: Comment
      description: Comment for the destination
      type: string
      required: false
  destinationsIdsList:
    id:
      title: Destinations Ids List
      description: example, 1234
      type: integer
      required: false
  dlEntity:
    id:
      title: ID
      description: Unique id of the destination list.
      type: integer
      required: false
    organizationId:
      title: Organization Id
      description: ID of org, e.g. 2345678
      type: integer
      required: false
    access:
      title: Access
      description: Access can be allow or block. It defines destinationList type, e.g. allow
      type: string
      required: false
    isGlobal:
      title: Is Global
      description: isGlobal can be true or false. There is only one default destination list of type allow or block for an organization.
      type: boolean
      required: false
    name:
      title: Name
      description: Name of the DL list
      type: string
      required: false
    thirdpartyCategoryId:
      title: Third Party Category Id
      description: example, 0
      type: integer
      required: false
    createdAt:
      title: Created At
      description: example, 1490206249
      type: integer
      required: false
    modifiedAt:
      title: Modified At
      description: example, 1490206249
      type: integer
      required: false
    isMspDefault:
      title: Is MSP Default
      description: example, false
      type: boolean
      required: false
    markedForDeletion:
      title: Marked For Deletion
      description: example, false
      type: boolean
      required: false
    meta:
      title: Meta Data
      description: None
      type: '[]meta'
      required: false
  destinationList:
    id:
      title: ID
      description: Unique id of the destination list.
      type: integer
      required: false
    organizationId:
      title: Organization Id
      description: ID of org, e.g. 2345678
      type: integer
      required: false
    access:
      title: Access
      description: Access can be allow or block. It defines destinationList type, e.g. allow
      type: string
      required: false
    isGlobal:
      title: Is Global
      description: isGlobal can be true or false. There is only one default destination list of type allow or block for an organization.
      type: boolean
      required: false
    name:
      title: Name
      description: Name of the DL list
      type: string
      required: false
    thirdpartyCategoryId:
      title: Third Party Category Id
      description: example, 0
      type: integer
      required: false
    createdAt:
      title: Created At
      description: example, 1490206249
      type: integer
      required: false
    modifiedAt:
      title: Modified At
      description: example, 1490206249
      type: integer
      required: false
    isMspDefault:
      title: Is MSP Default
      description: example, false
      type: boolean
      required: false
    markedForDeletion:
      title: Marked For Deletion
      description: example, false
      type: boolean
      required: false
  destinationsEntity:
    id:
      name: ID
      description: Unique ID of the destination
      type: string
      required: false
    destination:
      name: Destination
      description: Destination can be domain, url, ip
      type: string
      required: false
    typeOf:
      name: Type
      description: Type can be DOMAIN, URL, IPV4
      type: string
      required: false
    comment:
      name: Comment
      description: None
      type: string
      required: false
    createdAt:
      name: Created At
      description: date and time it has been created at, e.g. example 2018-07-23 19:36:45
      type: string #Docs say string, but should it be type(date)?
  dlDelete:
    delete:
      name: Delete
      description: Delete
      type: string
      required: false
actions:
  dlGetAll:
    title: Destinations List GET (All)
    description: Retrieve all destination lists of organisation
    input:
      organizationId:
        title: Organization ID
        description: Organisation ID
        type: integer
        required: true
    output:
      success:
        title: Success
        type: "[]dlCollection"
        required: true
  dlCreate:
    title: Destination Lists POST
    description: Create a destination list
    input:
      organizationId:
        title: Organization ID
        description: Organisation ID
        type: integer
        required: true
      payload:
        title: Payload
        description: List of destinations
        type: "[]dlCreate"
        required: true
    output:
      success:
        title: Success
        type: "[]dlEntity"
        required: true
  dlPatch:
    title: Destination Lists PATCH
    description: Rename a destination list
    input:
      organizationId:
        title: Organization ID
        description: Organisation ID
        type: integer
        required: true
      destinationListId:
        title: Destination List ID
        description: Unique ID for destination list
        type: integer
        required: true
      payload:
        title: Payload
        description: value containing name to change to
        type: "[]dlPatch"
    output:
      success:
        title: Success
        type: "[]dlEntity"
        required: true
  dlDelete:
    title: Destination Lists DELETE
    description: Delete a destination list
    input:
      organizationId:
        title: Organization ID
        description: Organisation ID
        type: integer
        required: true
      destinationListId:
        title: Destination List ID
        description: Unique ID for destination list
        type: integer
        required: true
    output:
      success:
        title: Success
        type: "[]dlDelete"
  dlGet:
    title: Destination List GET
    description: Return a destination list
    input:
      organizationId:
        title: Organization ID
        description: Organisation ID
        type: integer
        required: true
      destinationListId:
        title: Destination List ID
        description: Unique ID for destination list
        type: integer
        required: true
    output:
      success:
        title: Success
        type: '[]destinationList'
        required: true
  dGet:
    title: Destination GET
    description: Get list of destinations related to destination list
    input:
      organizationId:
        title: Organization ID
        description: Organisation ID
        type: integer
        required: true
      destinationListId:
        title: Destination List ID
        description: Unique ID for destination list
        type: integer
        required: true
      page:
        title: Page
        description: Pagination
        type: integer
        required: false
      limit:
        title: Limit
        description: Limit for page
        type: integer
        required: false
    output:
      success:
        title: Success
        type: '[]destinationsEntity'
        required: true
  dAdd:
    title: Destination POST
    description: Add list of destinations to destination list
    input:
      organizationId:
        title: Organization ID
        description: Organisation ID
        type: integer
        required: true
      destinationListId:
        title: Destination List ID
        description: Unique ID for destination list
        type: integer
        required: true
      payload:
        title: Payload
        description: List of destinations
        type: '[]destinationsList'
        required: true
    output:
      success:
        title: Success
        type: '[]dResponse'
        required: true
  dDelete:
    title: Destination DELETE
    description: Delete list of destinations from destination list
    input:
      organizationId:
        title: Organization ID
        description: Organisation ID
        type: integer
        required: true
      destinationListId:
        title: Destination List ID
        description: Unique ID for destination list
        type: integer
        required: true
      payload:
        title: Payload
        description: List of destinations
        type: "[]destinationsIdsList"
        required: true
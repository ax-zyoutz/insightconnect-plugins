plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: cisco_umbrella_destinations
title: Cisco Umbrella Destinations
version: 1.0.0
#TODO
#description: This plugin utilizes Cisco Umbrella to get the most complete view of the relationships
#  and evolution of Internet domains, IP addresses, and autonomous systems to pinpoint
#  attackers infrastructures and predict future threats
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/cisco_umbrella_destinations
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.cisco.com
tags:
- cisco
- umbrella
- destinations
hub_tags:
  #TODO
#  use_cases: [threat_detection_and_response]
  keywords: [cisco, umbrella, destinations]
  features: []
connection:
  api_key:
    title: API Key
    type: credential_secret_key
    description: Enter API key e.g. 1452d258-7c12-7c12-7c12-1452d25874c2
    required: true
    example: 1452d258-7c12-7c12-7c12-1452d25874c2

types:
  meta:
    destinationCount:
      type: integer
      description: Total number of destinations in a destination list.
      required: true
    domainCount:
      type: integer
      description: Total number of domains in a destination list. Domains are part of total destinations in a destination lists.
      required: true
    urlCount:
      type: integer
      description: Total number of Urls in a destination list. Urls are part of total destinations in a destination lists.
      required: true
    ipv4Count:
      type: integer
      description: Total number of Ip's in a destination list. Ip's are part of total destinations in a destination lists.
      required: true
  destinations:
    destination:
      type: string
      description: Destination can be domain, url or ip | e.g. <domain_name>
      required: true
    type:
      type: string
      description: Type can be DOMAIN, URL, IPV4 | e.g. DOMAIN
      required: true
    comment:
      type: string
      description: e.g. Added new destination list
      required: false
  dResponse:
    id:
      title: ID
      description: Unique id of the destination list.
      type: integer
      required: false
    organizationId:
      title: Organization Id
      description: ID of org, e.g. 2345678
      type: integer
      required: false
    access:
      title: Access
      description: Access can be allow or block. It defines destinationList type, e.g. allow
      type: string
      required: false
    isGlobal:
      title: Is Global
      description: isGlobal can be true or false. There is only one default destination list of type allow or block for an organization.
      type: boolean
      required: false
    name:
      title: Name
      description: Name of the DL list
      type: string
      required: false
    thirdpartyCategoryId:
      title: Third Party Category Id
      description: example, 0
      type: integer
      required: false
    createdAt:
      title: Created At
      description: example, 1490206249
      type: integer
      required: false
    modifiedAt:
      title: Modified At
      description: example, 1490206249
      type: integer
      required: false
    isMspDefault:
      title: Is MSP Default
      description: example, false
      type: boolean
      required: false
    markedForDeletion:
      title: Marked For Deletion
      description: example, false
      type: boolean
      required: false
    meta:
      title: Meta Data
      description: None
      type: '[]meta'
      required: false
  dlCollection:
    name: Destination List Collection
    description: Collection of destination lists
    type: '[]dlCollection'
    #TODO Review this ^^ .. so confusing
      id:
        title: ID
        description: Unique id of the destination list.
        type: integer
        required: true
      organizationId:
        title: Organization Id
        description: ID of org, e.g. 2345678
        type: integer
        required: true
      access:
        title: Access
        description: Access can be allow or block. It defines destinationList type, e.g. allow
        type: string
        required: true
      isGlobal:
        title: Is Global
        description: isGlobal can be true or false. There is only one default destination list of type allow or block for an organization.
        type: boolean
        required: true
      name:
        title: Name
        description: Name of the DL list
        type: string
        required: true
      thirdpartyCategoryId:
        title: Third Party Category Id
        description: example, 0
        type: integer
        required: true
      createdAt:
        title: Created At
        description: example, 1490206249
        type: integer
        required: true
      modifiedAt:
        title: Modified At
        description: example, 1490206249
        type: integer
        required: true
      isMspDefault:
        title: Is MSP Default
        description: example, false
        type: boolean
        required: true
      markedForDeletion:
        title: Marked For Deletion
        description: example, false
        type: boolean
        required: true
      meta:
        title: Meta Data
        description: None
        type: '[]meta'
        required: false
  dlCreate:
    access:
      name: Access
      description: Access can be allow or block. It defines destinationlist type.
      type: string
      required: true
    isGlobal:
      name: Is Global
      description: isGlobal can be true or false. There is only one default destination list of type allow or block for an organization.
      type: boolean
      required: true
    name:
      name: Name
      description: example, New Destination List
      type: string
      required: true
    destinations:
      name: Destinations
      description: Destinations to add to new list
      type: '[]destinations'
      required: false
  dlPatch:
    name:
      name: Name
      description: Name of the destination list
      type: string
      required: true
  destinationsList:
    destination:
      name: Destination Name
      description: Name of the destination
      type: string
      required: true
    comment:
      name: Comment
      description: Comment for the destination
      type: string
      required: false
  destinationsIdsList:
    name: Destinations Ids List
    description: example, 1234
    type: '[]integer'
    required: false
  dlEntity:
    id:
      title: ID
      description: Unique id of the destination list.
      type: integer
      required: false
    organizationId:
      title: Organization Id
      description: ID of org, e.g. 2345678
      type: integer
      required: false
    access:
      title: Access
      description: Access can be allow or block. It defines destinationList type, e.g. allow
      type: string
      required: false
    isGlobal:
      title: Is Global
      description: isGlobal can be true or false. There is only one default destination list of type allow or block for an organization.
      type: boolean
      required: false
    name:
      title: Name
      description: Name of the DL list
      type: string
      required: false
    thirdpartyCategoryId:
      title: Third Party Category Id
      description: example, 0
      type: integer
      required: false
    createdAt:
      title: Created At
      description: example, 1490206249
      type: integer
      required: false
    modifiedAt:
      title: Modified At
      description: example, 1490206249
      type: integer
      required: false
    isMspDefault:
      title: Is MSP Default
      description: example, false
      type: boolean
      required: false
    markedForDeletion:
      title: Marked For Deletion
      description: example, false
      type: boolean
      required: false
    meta:
      title: Meta Data
      description: None
      type: '[]meta'
      required: false
  destinationList:
    id:
      title: ID
      description: Unique id of the destination list.
      type: integer
      required: false
    organizationId:
      title: Organization Id
      description: ID of org, e.g. 2345678
      type: integer
      required: false
    access:
      title: Access
      description: Access can be allow or block. It defines destinationList type, e.g. allow
      type: string
      required: false
    isGlobal:
      title: Is Global
      description: isGlobal can be true or false. There is only one default destination list of type allow or block for an organization.
      type: boolean
      required: false
    name:
      title: Name
      description: Name of the DL list
      type: string
      required: false
    thirdpartyCategoryId:
      title: Third Party Category Id
      description: example, 0
      type: integer
      required: false
    createdAt:
      title: Created At
      description: example, 1490206249
      type: integer
      required: false
    modifiedAt:
      title: Modified At
      description: example, 1490206249
      type: integer
      required: false
    isMspDefault:
      title: Is MSP Default
      description: example, false
      type: boolean
      required: false
    markedForDeletion:
      title: Marked For Deletion
      description: example, false
      type: boolean
      required: false
  destinationsEntity:
    name: Destinations Entity
    description: None
    type: '[]destinationsEntity'
    id:
      name: ID
      description: Unique ID of the destination
      type: string
      required: false
    destination:
      name: Destination
      description: Destination can be domain, url, ip
      type: string
      required: false
    typeOf:
      name: Type
      description: Type can be DOMAIN, URL, IPV4
      type: string
      required: false
    comment:
      name: Comment
      description: None
      type: string
      required: false
    createdAt:
      name: Created At
      description: date and time it has been created at, e.g. example 2018-07-23 19:36:45
      type: string #Docs say string, but should it be type(date)?
  dlDelete:
    name: Destination List Delete
    description: None


actions:
#TODO
  get_destinationLists_forOrg:
    title: Destination List lookup for org ID
    description: Retrieve all destination lists of selected organization.
    input:
      organizationId:
        title: Organization Destination List Lookup
        description: Organization to lookup
        type: integer
        required: true
    output:
      orgDestinationList:
        title: Organisation Destination List
        description: #TODO Fill in later
        type: '[]model'
      meta:
        title: Meta data
        description: metadata for output
        type: '[]meta'
  create_destinationList:
    title: Create a destination list
    description: POST request to create a new destination list
    input:
      organizationId:
        title: Org ID
        description: Org ID to associate with list
        type: integer
        required: true
      payload:
        title: List of destinations
        description: Payload object with destinations used to create
        type:
        required: true

    output:

triggers:
#TODO

